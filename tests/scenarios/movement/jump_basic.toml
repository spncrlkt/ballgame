# Test: Player jumps
# Verifies jump input makes player gain height correctly
#
# FAIL conditions this test catches:
# - Jump not working: player stays on ground
# - Grounded state incorrect: player reports grounded=true while airborne
# - Jump too weak: player doesn't reach expected height

name = "Basic jump"
description = "Player gains vertical height when jump is pressed"

[setup]
level = "test_flat_floor"

# Floor at y=-450, floor top at -430, player center at -430 + 32 = -398
# Spawn at landing position to avoid fall delay
[[setup.entities]]
type = "player"
id = "p1"
team = "left"
x = 0.0
y = -398.0

# Jump immediately
[[input]]
frame = 5
p1 = { jump = true }

# Check at frame 15 - should be rising and airborne
[[expect.state]]
after_frame = 15
checks = [
    "p1.grounded = false",   # Should be in the air
    "p1.velocity_y > 0",     # Should be moving upward
    "p1.y > -350",           # Should be above starting position
]

# Check at frame 30 - near peak, still airborne
[[expect.state]]
after_frame = 30
checks = [
    "p1.grounded = false",   # Should still be in the air
    "p1.y > -250",           # Should have jumped significantly
]

# Check at frame 100 - should have landed
[[expect.state]]
after_frame = 100
checks = [
    "p1.grounded = true",    # Should be back on ground
]

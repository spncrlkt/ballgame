# Test: Max charge shot
# Verifies player can hold charge to maximum

name = "Max charge shot"
description = "Player charges shot to maximum before releasing"

[setup]
level = "test_flat_floor"

# Floor is at y=-450, spawn at -350 (100 above floor)
[[setup.entities]]
type = "player"
id = "shooter"
team = "left"
x = 0.0
y = -350.0
holding_ball = true

# Hold charge for full charge time (~1.5 seconds = 90 frames)
[[input]]
frame = 10
shooter = { throw_held = true }

[[input]]
frame = 100
shooter = { throw_held = false }

[[expect.sequence]]
event = "ShotStart"
player = "shooter"

[[expect.sequence]]
event = "ShotRelease"
player = "shooter"

[expect.state]
after_frame = 120
checks = [
    "shooter.holding_ball = false",
    "ball.state = InFlight",
]

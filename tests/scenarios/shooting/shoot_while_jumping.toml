# Test: Shoot while jumping
# Verifies player can shoot while airborne

name = "Shoot while jumping"
description = "Player jumps and shoots while in the air"

[setup]
level = "test_flat_floor"

[[setup.entities]]
type = "player"
id = "p1"
team = "left"
x = 0.0
y = -350.0
holding_ball = true

# Jump first
[[input]]
frame = 10
p1 = { jump = true }

# Start charging while in air
[[input]]
frame = 20
p1 = { throw_held = true }

# Release shot while still airborne
[[input]]
frame = 35
p1 = { throw_held = false }

[[expect.sequence]]
event = "ShotRelease"
player = "p1"
frame_min = 30
frame_max = 45

[[expect.state]]
after_frame = 40
checks = [
    "p1.grounded = false",  # Should still be in air when shot releases
    "ball.state = InFlight",
]

# Test: Steal succeeds or fails when in range
# Verifies steal attempt occurs when defender is close to ball holder
#
# FAIL conditions this test catches:
# - Steal system not triggering: no StealAttempt event
# - Range detection broken: attempt doesn't happen despite proximity

name = "Steal in range"
description = "Steal attempt happens when defender is close to ball holder"

[setup]
level = "test_steal_arena"

# Two players very close together (within STEAL_RANGE = 60)
# Floor at y=-450, floor top at -430, player center at -398
[[setup.entities]]
type = "player"
id = "holder"
team = "left"
x = 0.0
y = -398.0
holding_ball = true

[[setup.entities]]
type = "player"
id = "stealer"
team = "right"
x = 40.0
y = -398.0

# Stealer attempts steal while in range
[[input]]
frame = 10
stealer = { pickup = true }

# Check for StealAttempt event - this proves the steal system triggered
[[expect.sequence]]
event = "StealAttempt"
player = "stealer"
frame_min = 5
frame_max = 20

# State check at frame 30 - after the attempt
# We can't check the result (RNG-based) but we verify both players exist
# and the game state is consistent (knockback can push holder left)
[[expect.state]]
after_frame = 30
checks = [
    "holder.x > -200",        # Holder in arena (may be pushed by knockback)
    "stealer.x > -100",       # Stealer in arena
]

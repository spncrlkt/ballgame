{
  "requests": [
    {
      "name": "focused_core",
      "description": "Focused analysis core SQL queries for a single tournament DB",
      "db_path": null,
      "db_label": null,
      "queries": [
        {
          "name": "match_counts",
          "sql": "SELECT COUNT(*) AS matches FROM matches",
          "notes": null
        },
        {
          "name": "avg_duration",
          "sql": "SELECT AVG(duration_secs) AS avg_duration FROM matches",
          "notes": null
        },
        {
          "name": "goals_per_match",
          "sql": "SELECT AVG(score_left + score_right) AS goals_per_match FROM matches",
          "notes": null
        },
        {
          "name": "scoreless_rate",
          "sql": "SELECT AVG(CASE WHEN score_left + score_right = 0 THEN 1.0 ELSE 0.0 END) AS scoreless_rate FROM matches",
          "notes": null
        },
        {
          "name": "shots_total",
          "sql": "SELECT SUM(shots_attempted) AS shots_attempted, SUM(shots_made) AS shots_made FROM player_stats",
          "notes": null
        },
        {
          "name": "avg_shot_quality",
          "sql": "SELECT AVG(avg_shot_quality) AS avg_shot_quality FROM player_stats",
          "notes": null
        },
        {
          "name": "shot_start_events",
          "sql": "SELECT match_id, time_ms, data FROM events WHERE event_type = 'SS'",
          "notes": "Use to inspect shot start positions and quality."
        },
        {
          "name": "shot_release_events",
          "sql": "SELECT match_id, time_ms, data FROM events WHERE event_type = 'SR'",
          "notes": "Use to inspect shot charge, angle, and power."
        },
        {
          "name": "ai_goal_changes",
          "sql": "SELECT match_id, COUNT(*) AS ai_goal_changes FROM events WHERE event_type = 'AG' GROUP BY match_id",
          "notes": null
        },
        {
          "name": "steal_attempts",
          "sql": "SELECT match_id, COUNT(*) AS steal_attempts FROM events WHERE event_type = 'SA' GROUP BY match_id",
          "notes": null
        },
        {
          "name": "event_counts",
          "sql": "SELECT event_type, COUNT(*) AS count FROM events GROUP BY event_type",
          "notes": null
        },
        {
          "name": "low_shot_levels",
          "sql": "SELECT level_name, COUNT(*) AS matches FROM ( SELECT m.id, m.level_name, SUM(ps.shots_attempted) AS shots FROM matches m JOIN player_stats ps ON ps.match_id = m.id GROUP BY m.id ) WHERE shots <= 5 GROUP BY level_name ORDER BY matches DESC",
          "notes": null
        },
        {
          "name": "per_level_summary",
          "sql": "SELECT m.level_name, COUNT(DISTINCT m.id) AS matches, AVG(m.score_left + m.score_right) AS goals_per_match, SUM(ps.shots_attempted) AS shots_attempted, SUM(ps.shots_made) AS shots_made, AVG(CASE WHEN m.score_left + m.score_right = 0 THEN 1.0 ELSE 0.0 END) AS scoreless_rate, AVG(ps.avg_shot_quality) AS avg_shot_quality FROM matches m JOIN player_stats ps ON ps.match_id = m.id GROUP BY m.level_name ORDER BY scoreless_rate DESC, shots_attempted ASC",
          "notes": null
        }
      ]
    },
    {
      "name": "training_debug_overview",
      "description": "Training debug overview queries (debug_events vs events)",
      "db_path": null,
      "db_label": null,
      "queries": [
        {
          "name": "debug_event_count",
          "sql": "SELECT COUNT(*) AS debug_events FROM debug_events",
          "notes": null
        },
        {
          "name": "events_count",
          "sql": "SELECT COUNT(*) AS events FROM events",
          "notes": null
        },
        {
          "name": "debug_by_level",
          "sql": "SELECT level_id, COUNT(*) AS samples FROM debug_events GROUP BY level_id ORDER BY samples DESC",
          "notes": null
        },
        {
          "name": "debug_by_control",
          "sql": "SELECT human_controlled, COUNT(*) AS samples FROM debug_events GROUP BY human_controlled",
          "notes": "human_controlled=1 for human, 0 for AI"
        },
        {
          "name": "debug_time_range",
          "sql": "SELECT MIN(time_ms) AS min_time_ms, MAX(time_ms) AS max_time_ms FROM debug_events",
          "notes": null
        },
        {
          "name": "debug_without_events",
          "sql": "SELECT COUNT(*) AS debug_without_event FROM debug_events d LEFT JOIN events e ON e.match_id = d.match_id AND e.tick_frame = d.tick_frame WHERE e.id IS NULL",
          "notes": null
        },
        {
          "name": "events_without_debug",
          "sql": "SELECT COUNT(*) AS events_without_debug FROM events e LEFT JOIN debug_events d ON d.match_id = e.match_id AND d.tick_frame = e.tick_frame WHERE d.id IS NULL",
          "notes": null
        }
      ]
    }
  ]
}
